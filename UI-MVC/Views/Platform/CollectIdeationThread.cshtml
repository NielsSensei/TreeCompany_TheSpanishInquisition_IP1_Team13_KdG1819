@using Domain.UserInput
@model Domain.UserInput.IdeationQuestion
@inject UIMVC.Services.ProjectService ProjectService

@{
    ViewData["Title"] = Model.QuestionTitle;
}

@section Scripts
{
    <script type="module" src="~/dist/bootstrap_js.entry.js" defer></script>
    <script type="module" src="~/dist/closedfield.entry.js" defer></script>
    <script type="module" src="~/dist/changeclosedfield.entry.js" defer></script>
}

<div class="container">
    <div class="row">
        <div class="col-12">
            <h1>Ideation Thread</h1>
            <p class="font-weight-bold">@Model.QuestionTitle</p>
            <p>@Model.Description</p>
            @if (Model.SiteUrl != null)
            {
                <p>Lees meer: <a href="">@Model.SiteUrl</a></p>
            }
            <br/>
            <a class="btn btn-primary" asp-controller="Platform" asp-action="CollectIdeation"
               asp-route-id="@Model.Ideation.Id">Terug Naar Ideation</a>
        </div>
    </div>
    <hr/>
    <div class="row">
        <p>@ProjectService.CollectThreadIdeas(Model).Count() ideeÃ«n, heb jij er nog een?</p>
        @Html.Partial("Thread/_AddIdea", new AddIdeaModel(){ IdeationQuestionId = Model.Id, ParentId = 0 })
    </div>
    <br/>
    <div class="row">
        <p class="text-info">@ViewData["Message"]</p> 
    </div>
    <hr/>
    @foreach (Idea idea in ProjectService.CollectThreadIdeas(Model).Where(i => i.ParentIdea.Id == 0))
    {
        @Html.Partial("Thread/_CollectIdea", new IdeaViewModel()
        {
            ToView = idea, IdeaLevel = 0,
            Voting = ProjectService.CollectVoteSettings(Model)
        })
        <hr/>
    }
</div>
