@using Domain.Projects
@using Domain.UserInput
@using UIMVC.Services
@model Domain.Projects.Ideation
@inject UserService Userservice
@inject QuestionService Questionservice

@{
    Layout = "_Layout";
    ViewData["Title"] = Model.Title;
}

@section Tags
{
    <script type="module" src="./js/showmenu.js" defer></script>
}

<section class="container">
    <section class="row">
        <div class="col-5">
            <h2>@Model.Title</h2>
            <p>door @Userservice.CollectUserName(Model.User.Id)</p>
            @Html.Partial("_ReactionNumbersPartial", new LikeViewModel()
            {
                likeCount = Model.LikeCount, fbLikeCount = Model.FbLikeCount, twitterLikeCount = Model.TwitterLikeCount,
                shareCount = Model.ShareCount, retweetCount = Model.RetweetCount, iconStyle = 3
            })
            <p>@Model.ExtraInfo</p>
            @if (Model.Event.Id != 0)
            {
                @* TODO Zorgt voor een eventPagina *@
                <p>Deze ideation is georganiseerd dankzij dit evenement</p>
            }
            <section>
                <div class="row justify-content-between">
                    <h6 class="font-weight-bold">Tags:</h6>
                    @* TODO zet hier ne rolecheck op *@
                    <a class="btn btn-primary" asp-controller="Moderation" asp-action="AddTag"
                       formmethod="get" asp-route-ideation="@Model.Id">
                        Voeg een Tag Toe
                    </a>
                </div>
                
                @Html.Partial("_TagsPartial", Model.Tags)
                
            </section>

        </div>
        <div class="col-7">
            @* TODO vervang images door Media *@
            <img alt="IdeationMedia" src="https://via.placeholder.com/600x400"/>
        </div>
    </section>
    <hr>
    <section class="container">
        <div class="row justify-content-between">
            <div>
                @* TODO zet hier ne rolecheck op *@
                @if (Questionservice.CollectIdeationQuestions(Model.Id).Count == 0)
                {
                    <h1>Geen centrale vragen gesteld, wat jammer.</h1>
                }

                @if (Questionservice.CollectIdeationQuestions(Model.Id).Count == 1)
                {
                    <h1>1 centrale vraag</h1>
                }

                @if (Questionservice.CollectIdeationQuestions(Model.Id).Count > 1)
                {
                    <h1>@Questionservice.CollectIdeationQuestions(Model.Id).Count centrale vragen</h1>
                }
            </div>
            <a class="btn btn-primary h-25" method="get" asp-controller="Moderation" asp-action="AddCentralQuestion"
               asp-route-ideation="@Model.Id">
                Stel een nieuwe centrale vraag
            </a>
        </div>
        <section class="card-columns">
            @foreach (IdeationQuestion iq in Questionservice.CollectIdeationQuestions(Model.Id))
            {
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">@iq.QuestionTitle</h5>
                        <p class="card-text">@iq.Description</p>
                        @if (iq.SiteURL != null)
                        {
                            <p>Meer info: <a href="">@iq.SiteURL</a></p>
                        }
                    </div>
                    <div class="card-footer text-center">
                        <a class="btn btn-primary" asp-controller="Platform" asp-action="CollectIdeationThread" asp-route-id="@iq.Id">Ga naar Thread</a>

                    </div>
                </div>
            }
        </section>
    </section>
</section>
<hr/>